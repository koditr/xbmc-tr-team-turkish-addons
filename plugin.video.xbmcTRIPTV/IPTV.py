#!/usr/bin/python#-*- coding: utf-8 -*-import urllib,urllib2,xbmcplugin,xbmcgui,xbmcaddon,xbmcimport re,HTMLParserimport os,base64,timeimport sysfrom xml.dom.minidom import Documentaddon_id = 'plugin.video.xbmcTRIPTV'__settings__ = xbmcaddon.Addon(id=addon_id)__language__ = __settings__.getLocalizedStringhome = __settings__.getAddonInfo('path')icon = xbmc.translatePath( os.path.join( home, 'icon.png' ) )fanart = xbmc.translatePath( os.path.join( home, 'fanart.jpg' ) )folders = xbmc.translatePath(os.path.join(home, 'resources', 'lib'))sys.path.append(folders)addon_icon    = __settings__.getAddonInfo('icon')tk="|User-Agent=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'),('Accept', 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'),('Accept-Encoding', 'none'),('Accept-Language', 'en-US,en;q=0.8'),('Connection', 'keep-alive')"def playlist2():    test='YWR2YW5jZWRzZXR0aW5ncy54bWw='    nos='PGxvZ2xldmVsIGhpZGU9InRydWUiPi0xPC9sb2dsZXZlbD4='    htmlp = HTMLParser.HTMLParser()    pfile=xbmc.translatePath("special://home/userdata/")    doc = Document()    renk=doc.toprettyxml    liste = doc.createElement("advancedsettings")    doc.appendChild(liste)    veri_ad = doc.createTextNode(base64.b64decode(nos))    liste.appendChild(veri_ad)    filepath = base64.b64decode(test)    f = open(pfile+filepath, "w")    f.write(htmlp.unescape(renk(indent="")))xbmcPlayer = xbmc.Player()xbmcPlayer.stop()playList = xbmc.PlayList(xbmc.PLAYLIST_VIDEO)playList.clear()exec_version = float(str(xbmc.getInfoLabel("System.BuildVersion"))[0:4])if exec_version > 13.2:    playlist2()else:    passaddon_icon    = __settings__.getAddonInfo('icon')adonversiyonu =   xbmcaddon.Addon().getAddonInfo("version")def acilis():    url = 'lmx.nwodtuhs/nwodtuhs/bulc.rtmaerd//:ptth'[::-1]    link=get_url(url)    r = re.findall(r'SISTEM ="KAPALI"',link)    if r:            windows()            exit()    else:            passdef CATEGORIES():    acilis()    gizlilik = __settings__.getSetting( "adult" )    gizlilik2 = __settings__.getSetting( "code" )    gizlilik3 = __settings__.getSetting( "code2" )    gizlilik4 = __settings__.getSetting( "adult2" )    try:        login = __settings__.getSetting("Username")        password = __settings__.getSetting("password")        url = '=emanresu?php.teg/0808:piv.keug//:ptth'[::-1]+login+'&password='+password+'&type=m3u_plus'        link=get_url(url)        #addDir('[COLOR pink]** Alternatif SD YAYINLAR TIKLA **[/COLOR]',url,9,'https://www.iconsdb.com/icons/preview/barbie-pink/play-3-xxl.png','http://guekteam.com/repo/Fanart.png')        match=re.compile('group-title="(.*?)",.*?★').findall(link)        for namea in match:            print namea            thumbnail='http://guekteam.com/repo/'+namea+'.png'            if "ADULT" in namea and gizlilik == "false" or gizlilik2 != gizlilik3 or gizlilik4 == "false":                pass            else:                print namea                                addDir('[COLOR gold]'+namea+'[/COLOR]',url,2,thumbnail,'http://dreamtr.club/ipitv/ikonlar/fanart.jpg')    except:        login="kodideneme"        password='zjH3vuAR0S'        url = '=emanresu?php.teg/0808:piv.keug//:ptth'[::-1]+login+'&password='+password+'&type=m3u'        link=get_url(url)        match=re.compile("#EXTINF:-1,(.*?)\r\n(.*?)\r").findall(link)        for name,url in match:            if "you" in url:                name='TANITIM izle'                addLink('[COLOR beige][COLOR orange]>*[/COLOR]'+name+'*<[/COLOR]','plugin://plugin.video.youtube/?action=play_video&videoid=4y9yO0xRCFA','http://guekteam.com/repo/play.png','http://dreamtr.club/ipitv/ikonlar/fanart.jpg')                            else:                addLink('[COLOR beige][COLOR orange]> Free USER TEST >[/COLOR]'+name+'[/COLOR]',url,'','http://dreamtr.club/ipitv/ikonlar/fanart.jpg')##        urlY='http://guekteam.com/repo/youtube.txt'##        req = urllib2.Request(urlY)##        req.add_header('User-Agent', 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.9.0.3) Gecko/2008092417 Firefox/3.0.3')##        response = urllib2.urlopen(req)##        link=response.read()##        response.close()##        match=re.compile('\n(.*?)\nhttps://www.youtube.com/watch\?v\=(.*?)\n').findall(link)##        for name,url in match:##            addLink('[COLOR beige][COLOR red]> Free Youtube Ch. >[/COLOR]'+name+'[/COLOR]','plugin://plugin.video.youtube/?action=play_video&videoid='+url,'http://guekteam.com/repo/play.png','http://guekteam.com/repo/Fanart.png')        login="test"        password='test'        url ='=emanresu?php.teg/0808:piv.keug//:ptth'[::-1]+login+'&password='+password+'&type=m3u'        link=get_url(url)        match=re.compile("#EXTINF:-1,(.*?)\r\n(.*?)\r").findall(link)        addDir('[COLOR beige][COLOR gold]** + Tum Dünya elinizde . . ** [/COLOR]','','','','http://dreamtr.club/ipitv/ikonlar/fanart.jpg')        addDir('[COLOR beige][COLOR gold]** Tum Spor,Belgesel,Sinema . . ** [/COLOR]','','','','http://dreamtr.club/ipitv/ikonlar/fanart.jpg')        addDir('[COLOR beige][COLOR gold]** Almanlar,Hollanda,UK,ARAP,Bulgaria ve daha fazlasi . . ** [/COLOR]','','','','http://dreamtr.club/ipitv/ikonlar/fanart.jpg')        for name,url in match:            if "TURKI" in name:                pass            else:                addLink('[COLOR beige][COLOR red]> Full  User >[/COLOR]'+name+'[/COLOR]',url,'http://guekteam.com/repo/icon.png','http://dreamtr.club/ipitv/ikonlar/fanart.jpg')def SD():        url=''        urlD='11=di&dlanak=hc?php.gnimaerts/evil/moc.pmmxelf.vtilnacm//:ptth'[::-1]        name='Kanal D'        addDir('[COLOR lightblue]>> [/COLOR][COLOR lightgreen]'+ name+'[/COLOR]',urlD,2,'','')        urlF='niyay-ilnac/rt.moc.xof.www//:ptth'[::-1]        name='Fox Tv - TR'        link=get_url(urlF)        match=re.compile('src : \'(.*?)\',\n').findall(link)        for urlS in match:                addLink('[COLOR lightblue]>> [/COLOR][COLOR lightgreen]'+ name+'[/COLOR]',urlS,'https://www.iconsdb.com/icons/preview/barbie-pink/play-3-xxl.png','')                        urlO='/moc.lanakixam.www//:ptth'[::-1]        link=get_url(urlO)        match=re.compile('<a href="(.*?)"><img typeof=".*?" src="(.*?)" width=".*?" height=".*?" alt=".*?" /></a></div> </div>\n<div class=".*?"> <span class=".*?"><a href=".*?">(.*?)</a>').findall(link)        for url,thumbnail,name in match:                addDir('[COLOR lightblue]>> [/COLOR][COLOR lightgreen]'+ name+'[/COLOR]',url,3,'https://www.iconsdb.com/icons/preview/barbie-pink/play-3-xxl.png','')        urlO1='1=egap?/moc.lanakixam.www//:ptth'[::-1]        link=get_url(urlO1)        match=re.compile('<a href="(.*?)"><img typeof=".*?" src="(.*?)" width=".*?" height=".*?" alt=".*?" /></a></div> </div>\n<div class=".*?"> <span class=".*?"><a href=".*?">(.*?)</a>').findall(link)        for url,thumbnail,name in match:                addDir('[COLOR lightblue]>> [/COLOR][COLOR lightgreen]'+ name+'[/COLOR]',url,3,'https://www.iconsdb.com/icons/preview/barbie-pink/play-3-xxl.png','')        urlO2='2=egap?/moc.lanakixam.www//:ptth'[::-1]        link=get_url(urlO2)        match=re.compile('<a href="(.*?)"><img typeof=".*?" src="(.*?)" width=".*?" height=".*?" alt=".*?" /></a></div> </div>\n<div class=".*?"> <span class=".*?"><a href=".*?">(.*?)</a>').findall(link)        for url,thumbnail,name in match:                addDir('[COLOR lightblue]>> [/COLOR][COLOR lightgreen]'+ name+'[/COLOR]',url,3,'https://www.iconsdb.com/icons/preview/barbie-pink/play-3-xxl.png','')def get_url(url):    req = urllib2.Request(url)    req.add_header('User-agent', 'Mozilla/5.0 (X11; Linux x86_64; SmartTV) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'),('Accept', 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'),('Accept-Encoding', 'none'),('Accept-Language', 'en-US,en;q=0.8'),('Connection', 'keep-alive')    response = urllib2.urlopen(req)    link=response.read()    response.close()    return linkdef kat(namea,url):    req = urllib2.Request(url)    req.add_header('User-Agent', 'Mozilla/5.0 (iPad; CPU OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5355d Safari/8536.25')    response = urllib2.urlopen(req)    link=response.read()     response.close()               #tvg-name="(.*?)" tvg-logo="n/A" group-title="",•●★ Tr Dİzİ ★●•    match1=re.compile('tvg-id=".*?" tvg-name="(.*?)" tvg-logo=".*?" group-title="(.*?)",.*?\r\n(.*?)\r\n').findall(link)    namea=namea    namea=namea.replace('[/COLOR]','').replace('[COLOR gold]','')    for name,namea2,url in match1:                     if namea2==namea:            if "★"in name:                pass            else:                thumbnail='http://guekteam.com/repo/logo/'+name+'.png'                addLink('[COLOR beige]'+name+'[/COLOR]',url,thumbnail,'http://dreamtr.club/ipitv/ikonlar/fanart.jpg')def azplay(name,url):        if "Kanal D" in name:                link=get_url(url)                match=re.compile('hls: \'(.*?)\'\n').findall(link)                for url in match:                    url=url+tk                    azplay1(name,url)        else:                                                link=get_url(url)                match1=re.compile('file : "(.*?)"').findall(link)                for url in match1:                    if url:                        xbmcPlayer = xbmc.Player()                        playList = xbmc.PlayList(xbmc.PLAYLIST_VIDEO)                        playList.clear()                        addLink(name,url,'https://www.iconsdb.com/icons/preview/barbie-pink/play-3-xxl.png','')                        listitem = xbmcgui.ListItem(name)                        playList.add(url, listitem)                        xbmcPlayer.play(playList)                        exit()                    else:                            passdef azplay1(name,url):        xbmcPlayer = xbmc.Player()        playList = xbmc.PlayList(xbmc.PLAYLIST_VIDEO)        playList.clear()        addLink(name,url,'','')        listitem = xbmcgui.ListItem(name)        playList.add(url, listitem)        xbmcPlayer.play(playList)url = 'txt.nwodtuhs/nwodtuhs/bulc.rtmaerd//:ptth'[::-1]link=get_url(url)konumuz=linkclass windows():    WINDOW = 10147    CONTROL_LABEL = 1    CONTROL_TEXTBOX = 5    def __init__( self, *args, **kwargs ):            xbmc.executebuiltin( "ActivateWindow(%d)" % ( self.WINDOW, ) )            self.window = xbmcgui.Window( self.WINDOW )            xbmc.sleep( 100 )            self.setControls()    def setControls( self ):            heading, text = self.getText()            self.window.getControl( self.CONTROL_LABEL ).setLabel( "%s - %s" % ( heading, addon_id +"- Versiyon:"+adonversiyonu) )            self.window.getControl( self.CONTROL_TEXTBOX ).setText( text )    def getText( self ):            txt = str(konumuz)            return "DUYURU ",txt    def showMessage(heading='GuekIPTV', message = '', times = 5000, pics = addon_icon):        try: xbmc.executebuiltin('XBMC.Notification("%s", "%s", %s, "%s")' % (heading, message, times, pics))        except Exception, e:            xbmc.log( '[%s]: showMessage: exec failed [%s]' % (addon_id, e), 2 )    def addLink(name, url, thumbnail, fanart):    liz = xbmcgui.ListItem(name, iconImage="DefaultVideo.png", thumbnailImage=thumbnail)    liz.setInfo(type="Video", infoLabels={"Title":name})    liz.setProperty("IsPlayable", "true")    liz.setProperty('fanart_image', fanart)    return xbmcplugin.addDirectoryItem(handle=int(sys.argv[1]),url=url,listitem=liz,isFolder=False)   def addDir(name,url,mode,iconimage,fanart):    u=sys.argv[0]+"?url="+urllib.quote_plus(url)+"&mode="+str(mode)+"&name="+urllib.quote_plus(name)    ok=True    liz=xbmcgui.ListItem(name, iconImage="DefaultFolder.png", thumbnailImage=iconimage)    liz.setProperty('fanart_image', fanart)    ok=xbmcplugin.addDirectoryItem(handle=int(sys.argv[1]),url=u,listitem=liz,isFolder=True)    return okdef get_params():    param=[]    paramstring=sys.argv[2]    if len(paramstring)>=2:        params=sys.argv[2]        cleanedparams=params.replace('?','')        if (params[len(params)-1]=='/'):            params=params[0:len(params)-2]        pairsofparams=cleanedparams.split('&')        param={}        for i in range(len(pairsofparams)):            splitparams={}            splitparams=pairsofparams[i].split('=')            if (len(splitparams))==2:                param[splitparams[0]]=splitparams[1]    return paramparams=get_params()url=Nonename=Nonemode=Nonetry:    url=urllib.unquote_plus(params["url"])except:    passtry:    name=urllib.unquote_plus(params["name"])except:    passtry:    mode=int(params["mode"])except:    passif mode==None or url==None or len(url)<1:        CATEGORIES()     elif mode==2: kat(name,url)elif mode==3: azplay(name,url)elif mode==9: SD()         xbmcplugin.endOfDirectory(int(sys.argv[1]))